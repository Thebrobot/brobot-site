---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/Navbar';
import FloatingMenu from '../components/FloatingMenu';
import Footer from '../components/Footer';
import { Mail, Phone, Send, Activity, Shield, MessageSquare, CheckCircle2, ArrowRight } from 'lucide-react';

const pathname = "/contact";
---

<BaseLayout title="Contact | Brobot Media">
  <main class="min-h-screen bg-[#020617] text-white">
    <Navbar client:load pathname={pathname} />
    
    <section class="pt-48 pb-32 px-6 relative overflow-hidden">
      <!-- Ambient Background Glows -->
      <div class="absolute top-0 left-1/4 w-[500px] h-[500px] bg-amber-600/10 blur-[120px] rounded-full -z-10"></div>
      <div class="absolute bottom-0 right-1/4 w-[500px] h-[500px] bg-amber-600/5 blur-[120px] rounded-full -z-10"></div>

      <div class="container mx-auto max-w-6xl relative z-10">
        <!-- Header -->
        <div class="text-center mb-16">
          <div class="flex items-center justify-center gap-3 mb-8 text-amber-500">
            <Activity class="w-4 h-4 animate-pulse" />
            <span class="text-[10px] font-black uppercase tracking-[0.5em]">Transmission_Hub</span>
          </div>
          
          <h1 class="text-6xl md:text-8xl font-display font-black tracking-tighter mb-8 leading-[0.9]">
            INITIATE <br />
            <span class="text-amber-500 italic">SCALING.</span>
          </h1>
          
          <p class="text-xl text-white font-medium mb-12 leading-relaxed max-w-2xl mx-auto">
            Ready to stop missing calls and start booking more appointments? Choose how to reach us.
          </p>

          <!-- Quick Action Channels -->
          <div class="flex flex-col sm:flex-row items-center justify-center gap-3 max-w-2xl mx-auto mb-20">
            <a 
              href="tel:+19802762687"
              class="group w-full sm:w-auto px-8 py-4 bg-white/[0.02] border border-white/10 hover:border-amber-500/50 hover:bg-white/[0.04] rounded-full transition-all flex items-center justify-center gap-3"
            >
              <Phone class="h-4 w-4 text-amber-500" />
              <span class="text-[11px] font-black uppercase tracking-[0.3em] text-white">Voice_Line</span>
            </a>
            
            <a 
              href="mailto:Info@thebrobot.com"
              class="group w-full sm:w-auto px-8 py-4 bg-white/[0.02] border border-white/10 hover:border-amber-500/50 hover:bg-white/[0.04] rounded-full transition-all flex items-center justify-center gap-3"
            >
              <Mail class="h-4 w-4 text-amber-500" />
              <span class="text-[11px] font-black uppercase tracking-[0.3em] text-white">Direct_Mail</span>
            </a>
            
            <button 
              onclick="(function() { const chatWidget = document.querySelector('chat-widget'); if (chatWidget && chatWidget.shadowRoot) { const shadowButton = chatWidget.shadowRoot.querySelector('#lc_text-widget--btn'); if (shadowButton) { shadowButton.click(); } } })()"
              class="group w-full sm:w-auto px-8 py-4 bg-amber-600 hover:bg-amber-500 border border-amber-500/50 rounded-full transition-all flex items-center justify-center gap-3 shadow-[0_0_30px_-10px_rgba(245,158,11,0.5)]"
            >
              <MessageSquare class="h-4 w-4 text-white" />
              <div class="text-center">
                <div class="text-[11px] font-black uppercase tracking-[0.3em] text-white leading-tight">Send_Message</div>
                <div class="text-[8px] text-white/70 font-medium uppercase tracking-wider mt-0.5">Initiate Live Chat</div>
              </div>
            </button>
          </div>

          <!-- Protocol Sequence -->
          <div class="max-w-4xl mx-auto mb-4">
            <div class="flex items-center justify-center gap-3 mb-8">
              <Activity class="w-4 h-4 text-amber-500 animate-pulse" />
              <span class="text-[11px] font-black uppercase tracking-[0.5em] text-white">Deployment_Protocol</span>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
              <div class="relative">
                <div class="text-xs font-black uppercase tracking-[0.3em] text-amber-500 mb-2">01_Train</div>
                <div class="text-base text-white font-medium">Voice clone + knowledge</div>
              </div>
              <div class="relative">
                <div class="text-xs font-black uppercase tracking-[0.3em] text-amber-500 mb-2">02_Integrate</div>
                <div class="text-base text-white font-medium">Calendar, CRM, phone</div>
              </div>
              <div class="relative">
                <div class="text-xs font-black uppercase tracking-[0.3em] text-amber-500 mb-2">03_Live</div>
                <div class="text-base text-white font-medium">Agent answers 24/7</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Two Column Layout -->
        <div class="flex flex-col lg:flex-row gap-16" id="contact-form">
          <!-- Left Column: Contact Info -->
          <div class="flex-1">
            <div class="space-y-10">
              <a 
                href="mailto:Info@thebrobot.com"
                class="flex items-center gap-8 group cursor-pointer"
              >
                <div class="h-16 w-16 rounded-[24px] bg-white/[0.03] border border-white/10 flex items-center justify-center text-amber-500 group-hover:bg-amber-600/20 transition-all duration-500">
                  <Mail class="h-7 w-7" />
                </div>
                <div>
                  <p class="text-[10px] font-black uppercase tracking-[0.3em] text-white mb-1">Direct_Mail</p>
                  <p class="text-xl font-bold text-white group-hover:text-amber-400 transition-colors">Info@thebrobot.com</p>
                </div>
              </a>
              
              <a 
                href="tel:+19802762687"
                class="flex items-center gap-8 group cursor-pointer"
              >
                <div class="h-16 w-16 rounded-[24px] bg-white/[0.03] border border-white/10 flex items-center justify-center text-amber-500 group-hover:bg-amber-600/20 transition-all duration-500">
                  <Phone class="h-7 w-7" />
                </div>
                <div>
                  <p class="text-[10px] font-black uppercase tracking-[0.3em] text-white mb-1">Voice_Line</p>
                  <p class="text-xl font-bold text-white group-hover:text-amber-400 transition-colors">980 BRO-BOTS</p>
                  <p class="text-xs text-slate-600 font-medium mt-1">(980-276-2687)</p>
                </div>
              </a>
            </div>

            <div class="mt-16 space-y-6">
              <div class="flex items-start gap-4">
                <Shield class="w-5 h-5 text-emerald-400 flex-shrink-0 mt-1" />
                <div>
                  <div class="text-sm font-bold text-white mb-1">No Spam Promise</div>
                  <div class="text-xs text-white">Real human responses. If we're not a fit, we'll tell you honestly.</div>
                </div>
              </div>
              <div class="flex items-start gap-4">
                <CheckCircle2 class="w-5 h-5 text-emerald-400 flex-shrink-0 mt-1" />
                <div>
                  <div class="text-sm font-bold text-white mb-1">Secure & Private</div>
                  <div class="text-xs text-white">End-to-end encryption. Your info stays confidential.</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column: Form -->
          <div class="flex-1 relative">
            <div class="absolute inset-0 bg-amber-600/5 blur-3xl rounded-[60px]"></div>
            <div class="relative bg-white/[0.02] backdrop-blur-3xl border border-white/10 rounded-[60px] p-10 md:p-14 shadow-2xl">
              <!-- Success Message (hidden by default) -->
              <div id="success-message" class="hidden text-center py-12">
                <div class="w-20 h-20 rounded-full bg-emerald-500/20 flex items-center justify-center mx-auto mb-6">
                  <CheckCircle2 class="w-10 h-10 text-emerald-500" />
                </div>
                <h3 class="text-3xl font-black text-white mb-3">Message Sent!</h3>
                <p class="text-white mb-6">We'll reply within 2 hours. Check your email for our response.</p>
                <button 
                  onclick="location.reload()"
                  class="text-amber-400 hover:text-amber-300 font-bold text-sm uppercase tracking-widest"
                >
                  Send Another Message
                </button>
              </div>

              <!-- Form -->
              <form id="contact-form-element" class="space-y-8">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div class="space-y-3">
                    <label for="name" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                      Name <span class="text-amber-500">*</span>
                    </label>
                    <input 
                      id="name"
                      name="name"
                      type="text" 
                      required
                      class="w-full h-16 px-8 rounded-[24px] bg-white/[0.03] border border-white/10 text-white placeholder:text-slate-700 focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none font-medium" 
                      placeholder="John Doe" 
                    />
                  </div>
                  <div class="space-y-3">
                    <label for="email" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                      Email <span class="text-amber-500">*</span>
                    </label>
                    <input 
                      id="email"
                      name="email"
                      type="email" 
                      required
                      class="w-full h-16 px-8 rounded-[24px] bg-white/[0.03] border border-white/10 text-white placeholder:text-slate-700 focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none font-medium" 
                      placeholder="john@example.com" 
                    />
                  </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div class="space-y-3">
                    <label for="phone" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                      Phone <span class="text-amber-500">*</span>
                    </label>
                    <input 
                      id="phone"
                      name="phone"
                      type="tel" 
                      required
                      class="w-full h-16 px-8 rounded-[24px] bg-white/[0.03] border border-white/10 text-white placeholder:text-slate-700 focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none font-medium" 
                      placeholder="(555) 000-0000" 
                    />
                  </div>
                  <div class="space-y-3">
                    <label for="business" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                      Business Name
                    </label>
                    <input 
                      id="business"
                      name="business"
                      type="text" 
                      class="w-full h-16 px-8 rounded-[24px] bg-white/[0.03] border border-white/10 text-white placeholder:text-slate-700 focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none font-medium" 
                      placeholder="Acme Inc." 
                    />
                  </div>
                </div>

                <div class="space-y-3">
                  <label for="industry" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                    Industry / Service Type
                  </label>
                  <select 
                    id="industry"
                    name="industry"
                    class="w-full h-16 px-8 rounded-[24px] bg-white/[0.03] border border-white/10 text-white focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none font-medium"
                  >
                    <option value="" class="bg-[#020617]">Select your industry...</option>
                    <option value="Business Coaching" class="bg-[#020617]">Business Coaching</option>
                    <option value="Car Detailing" class="bg-[#020617]">Car Detailing</option>
                    <option value="Credit Repair" class="bg-[#020617]">Credit Repair</option>
                    <option value="Dentist" class="bg-[#020617]">Dentist</option>
                    <option value="Electrician" class="bg-[#020617]">Electrician</option>
                    <option value="Events" class="bg-[#020617]">Events</option>
                    <option value="Financial Planning" class="bg-[#020617]">Financial Planning</option>
                    <option value="General Contractor" class="bg-[#020617]">General Contractor</option>
                    <option value="Gym / Fitness" class="bg-[#020617]">Gym / Fitness</option>
                    <option value="HVAC" class="bg-[#020617]">HVAC</option>
                    <option value="Junk Removal" class="bg-[#020617]">Junk Removal</option>
                    <option value="Life Insurance" class="bg-[#020617]">Life Insurance</option>
                    <option value="Med Spa" class="bg-[#020617]">Med Spa</option>
                    <option value="Mortgage" class="bg-[#020617]">Mortgage</option>
                    <option value="Moving Company" class="bg-[#020617]">Moving Company</option>
                    <option value="Plumbing" class="bg-[#020617]">Plumbing</option>
                    <option value="Pressure Washing" class="bg-[#020617]">Pressure Washing</option>
                    <option value="Real Estate" class="bg-[#020617]">Real Estate</option>
                    <option value="Roofing" class="bg-[#020617]">Roofing</option>
                    <option value="Solar" class="bg-[#020617]">Solar</option>
                    <option value="Weight Loss" class="bg-[#020617]">Weight Loss</option>
                    <option value="Other" class="bg-[#020617]">Other</option>
                  </select>
                </div>

                <div class="space-y-3">
                  <label for="social" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                    Social Media Handle
                  </label>
                  <input 
                    id="social"
                    name="social"
                    type="text" 
                    class="w-full h-16 px-8 rounded-[24px] bg-white/[0.03] border border-white/10 text-white placeholder:text-slate-700 focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none font-medium" 
                    placeholder="@yourbusiness or profile URL" 
                  />
                </div>
                
                <div class="space-y-3">
                  <label for="message" class="text-[10px] font-black uppercase tracking-[0.2em] text-white ml-2">
                    What do you need help with? <span class="text-amber-500">*</span>
                  </label>
                  <textarea 
                    id="message"
                    name="message"
                    rows="4" 
                    required
                    class="w-full p-8 rounded-[32px] bg-white/[0.03] border border-white/10 text-white placeholder:text-slate-700 focus:border-amber-500 focus:bg-white/[0.05] transition-all outline-none resize-none font-medium" 
                    placeholder="Tell us about your business goals and what you'd like to automate..."
                  ></textarea>
                  <p class="text-[9px] font-bold uppercase tracking-[0.2em] text-slate-600 ml-2 mt-2">
                    ðŸ’¡ Interested in voice cloning? Mention it in your message.
                  </p>
                </div>

                <!-- Opt-in Checkboxes -->
                <div class="space-y-4">
                  <!-- Service/Account SMS Opt-in -->
                  <div class="flex items-start gap-4 p-6 rounded-[24px] bg-white/[0.02] border border-white/10">
                    <input 
                      id="opt-in-service"
                      name="opt-in-service"
                      type="checkbox"
                      class="mt-1 w-5 h-5 rounded border-2 border-white/20 bg-white/[0.05] text-amber-600 focus:ring-2 focus:ring-amber-500/50 focus:ring-offset-0 cursor-pointer accent-amber-600 flex-shrink-0"
                    />
                    <label for="opt-in-service" class="flex-1 text-xs text-slate-300 leading-relaxed cursor-pointer">
                      I agree to receive SMS messages from The Brobot related to my account, CRM software updates, service notifications, and important client communications. Message frequency may vary. Message and data rates may apply. Reply STOP to unsubscribe, HELP for help.
                    </label>
                  </div>

                  <!-- Marketing SMS Opt-in (Optional) -->
                  <div class="flex items-start gap-4 p-6 rounded-[24px] bg-white/[0.02] border border-white/10">
                    <input 
                      id="opt-in-marketing"
                      name="opt-in-marketing"
                      type="checkbox"
                      class="mt-1 w-5 h-5 rounded border-2 border-white/20 bg-white/[0.05] text-amber-600 focus:ring-2 focus:ring-amber-500/50 focus:ring-offset-0 cursor-pointer accent-amber-600 flex-shrink-0"
                    />
                    <label for="opt-in-marketing" class="flex-1 text-xs text-slate-300 leading-relaxed cursor-pointer">
                      I agree to receive SMS messages from The Brobot related to product announcements, new features, promotions, and marketing offers. Message frequency may vary. Message and data rates may apply. Reply STOP to unsubscribe, HELP for help. Consent is not a condition of purchase.
                    </label>
                  </div>
                </div>
                
                <button 
                  type="submit"
                  id="submit-btn"
                  class="w-full h-20 bg-amber-600 text-white rounded-[24px] font-black text-lg uppercase tracking-[0.2em] hover:bg-amber-500 transition-all flex items-center justify-center gap-4 shadow-[0_0_50px_-10px_rgba(245,158,11,0.5)] group disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  <span id="submit-text">Deploy_Message</span>
                  <Send id="submit-icon" class="h-5 w-5 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform" />
                  <svg id="submit-spinner" class="hidden animate-spin h-6 w-6 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                </button>

                <p class="text-center text-slate-600 text-[9px] font-bold uppercase tracking-widest">
                  Secure channel established. Response time: &lt; 2 hours.
                </p>
              </form>
            </div>
          </div>
        </div>
      </div>
    </section>

    <FloatingMenu client:load pathname={pathname} />
    
    <Footer client:visible />
  </main>
</BaseLayout>

<script is:inline>
  (function () {
    const GHL_WEBHOOK_URL = "https://services.leadconnectorhq.com/hooks/nUFqlRRkiJoqpyubsiaD/webhook-trigger/f9a25467-80f7-40b2-bf75-db28dec253a3";

    function initContactForm() {
      const form = document.getElementById("contact-form-element");
      const successMessage = document.getElementById("success-message");
      const submitBtn = document.getElementById("submit-btn");
      const submitText = document.getElementById("submit-text");
      const submitIcon = document.getElementById("submit-icon");
      const submitSpinner = document.getElementById("submit-spinner");

      if (!form) return;

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        // Get form data
        const formData = new FormData(form);
        const data = {
          source: "brobot-contact-page",
          submittedAt: new Date().toISOString(),
          pageUrl: window.location.href,
          name: formData.get("name"),
          email: formData.get("email"),
          phone: formData.get("phone"),
          business: formData.get("business") || "",
          industry: formData.get("industry") || "",
          social: formData.get("social") || "",
          message: formData.get("message"),
          // Separate opt-ins for compliance
          optInService: formData.get("opt-in-service") === "on", // Required: Service/account messages
          optInMarketing: formData.get("opt-in-marketing") === "on", // Optional: Marketing messages
          optInTimestamp: new Date().toISOString(), // Compliance timestamp
        };

        // Show loading state
        submitBtn.disabled = true;
        submitText.classList.add("hidden");
        submitIcon.classList.add("hidden");
        submitSpinner.classList.remove("hidden");

        try {
          const response = await fetch(GHL_WEBHOOK_URL, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(data),
          });

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}`);
          }

          // Show success message
          form.classList.add("hidden");
          successMessage.classList.remove("hidden");

          // Track conversion (if you have analytics)
          if (window.gtag) {
            window.gtag("event", "generate_lead", {
              event_category: "Contact",
              event_label: "Contact Form Submission",
            });
          }
        } catch (error) {
          console.error("Form submission error:", error);
          alert("There was an error sending your message. Please try calling or emailing us directly.");
          
          // Reset button state
          submitBtn.disabled = false;
          submitText.classList.remove("hidden");
          submitIcon.classList.remove("hidden");
          submitSpinner.classList.add("hidden");
        }
      });
    }

    // Initialize on page load
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", initContactForm);
    } else {
      initContactForm();
    }

    // Re-initialize on Astro page transitions
    document.addEventListener("astro:after-swap", initContactForm);
  })();
</script>
